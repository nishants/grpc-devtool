steps:
  # Ensure required node version is installed
  # https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/tool/node-js?view=azure-devops
  - task: NodeTool@0
    inputs:
      versionSpec: '>= 10.0.0'

  - script: |
      cd app
      yarn
    displayName: 'npm install'

  - script: |
      cd app
      yarn make
    displayName: 'Build electron app'

  - task: CopyFiles@2
    inputs:
      sourceFolder: '$(System.DefaultWorkingDirectory)/app/out'
      targetFolder: '$(Build.ArtifactStagingDirectory)'
      flattenFolders: true
      cleanTargetFolder: true
      preserveTimestamp: true
      contents: '**/*.zip'
      overWrite: false
      #contents: '**/$(BuildConfiguration)/**/?(*.exe|*.dll|*.pdb)'

  - task: PublishPipelineArtifact@1
    inputs:
      artifactName: 'Mojave' # Optional
      targetPath: '$(Build.ArtifactStagingDirectory)' # Required
      artifactType: 'pipeline' # Required. Options: pipeline, filepath. Default value: pipeline
      #fileSharePath: '\server\folderName' # Required when artifactType = filepath
